import{T as d,U as D,W as f,S as w,P as g,a as P,M,b as _,c as m}from"./three.2d89e9c8.js";import{G as L,I as r,d as b,H as U,A as x,J as y}from"./element-plus.dee36745.js";function h(s=0){return function(e,t,n){const o=n.value;n.value=L(o,s)}}var v=Object.defineProperty,R=Object.getOwnPropertyDescriptor,a=(s,e,t,n)=>{for(var o=n>1?void 0:n?R(e,t):e,c=s.length-1,l;c>=0;c--)(l=s[c])&&(o=(n?l(e,t,o):l(o))||o);return n&&o&&v(e,t,o),o};const T=["https://qhyxpicoss.kujiale.com/r/2019/07/01/L3D137S8ENDIADDWAYUI5L7GLUF3P3WS888_3000x4000.jpg?x-oss-process=image/resize,m_fill,w_1600,h_920/format,webp","https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimg.zcool.cn%2Fcommunity%2F01dead58f03a61a8012049ef124133.jpg%403000w_1l_2o_100sh.jpg&refer=http%3A%2F%2Fimg.zcool.cn&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1636353181&t=8986b8074d4093d2fdc187ee5f562bd0"];class i{sceneUrl=T[Math.round(Math.random())];camera;scene;renderer;isUserInteracting=!0;onPointerDownPointerX=0;onPointerDownPointerY=0;lon=0;onPointerDownLon=0;lat=0;onPointerDownLat=0;phi=0;theta=0;target="";refs;throttleTime=0;constructor(e,t){this.target=e,this.refs=t,this.init()}init(){new d().load(this.sceneUrl,t=>{t.mapping=D,this.initImg(t),this.render()})}initImg(e){let t;const n=this.refs?.offsetWidth||window.innerWidth,o=this.refs?.offsetHeight||window.innerHeight;if(this.target)t=document.querySelector(this.target);else throw new Error(`target is not existed: ${this.target}`);if(this.renderer=new f({antialias:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(n,o),t?.childNodes?.length){const p=t?.childNodes;t.removeChild(p[0]),t.appendChild(this.renderer.domElement)}else t?.appendChild(this.renderer.domElement);this.scene=new w,this.camera=new g(60,n/o,1,1e3);const c=new P(500,32,16),l=new M({map:e}),u=new _(c,l);u.geometry.scale(-1,1,1),this.scene.add(u),r(t,"mousedown",this.onDocumentMouseDown.bind(this)),r(t,"mousemove",this.onDocumentMouseMove.bind(this)),r(t,"mouseup",this.onDocumentMouseUp.bind(this)),r(t,"mousewheel",this.onDocumentMouseWheel.bind(this)),r(t,"touchstart",this.onDocumentTouchStart.bind(this)),r(t,"touchmove",this.onDocumentTouchMove.bind(this))}onDocumentMouseDown(e){e.preventDefault(),this.isUserInteracting=!0,this.onPointerDownPointerX=e.clientX,this.onPointerDownPointerY=e.clientY,this.onPointerDownLon=this.lon,this.onPointerDownLat=this.lat}onDocumentMouseMove(e){this.isUserInteracting&&(this.lon=(this.onPointerDownPointerX-e.clientX)*.1+this.onPointerDownLon,this.lat=(e.clientY-this.onPointerDownPointerY)*.1+this.onPointerDownLat,this.render())}onDocumentMouseUp(){this.isUserInteracting=!1,this.render()}onDocumentMouseWheel(e){this.camera.fov-=e.wheelDeltaY*.05,this.camera.updateProjectionMatrix(),e=e||window.event,e?.stopPropagation?e.stopPropagation():e.cancelBubble=!0,e?.preventDefault?e.preventDefault():e.returnValue=!1,this.render()}onDocumentTouchStart(e){e?.touches?.length===1&&(e.preventDefault(),this.onPointerDownPointerX=e.touches[0].pageX,this.onPointerDownPointerY=e.touches[0].pageY,this.onPointerDownLon=this.lon,this.onPointerDownLat=this.lat)}onDocumentTouchMove(e){e?.touches?.length===1&&(e.preventDefault(),this.lon=(this.onPointerDownPointerX-e.touches[0].pageX)*.1+this.onPointerDownLon,this.lat=(e.touches[0].pageY-this.onPointerDownPointerY)*.1+this.onPointerDownLat,this.render())}render(){this.lon+=.15,this.lat=Math.max(-85,Math.min(85,this.lat)),this.phi=m.degToRad(90-this.lat),this.theta=m.degToRad(this.lon),this.camera.position.x=100*Math.sin(this.phi)*Math.cos(this.theta),this.camera.position.y=100*Math.cos(this.phi),this.camera.position.z=100*Math.sin(this.phi)*Math.sin(this.theta),this.camera.lookAt(this.scene.position),this.renderer.render(this.scene,this.camera)}}a([h()],i.prototype,"onDocumentMouseDown",1);a([h()],i.prototype,"onDocumentMouseMove",1);a([h()],i.prototype,"onDocumentMouseUp",1);a([h()],i.prototype,"onDocumentMouseWheel",1);a([h()],i.prototype,"onDocumentTouchStart",1);a([h()],i.prototype,"onDocumentTouchMove",1);const W=b({__name:"index",setup(s){const e=$shallowRef(document.documentElement);return U(()=>{new i("#VR",e)}),(t,n)=>(x(),y("div",{id:"VR",ref_key:"vrRoomRef",ref:e},null,512))}});export{W as default};
