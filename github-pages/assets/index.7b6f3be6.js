import{f as z,u as W,a as X,g as Y,r as ee,d as T,o as te,c as ae,b as ne,_ as le}from"./index.311e097d.js";/* empty css                    *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                         */import{_ as oe}from"./setting.136ae06d.js";import{d as N,P as a,aA as ue,aB as se,aC as re,aD as de,aE as ce,b as E,aF as ie,aG as pe,aH as fe,aI as ve,aJ as _e,aK as me,a4 as be,a5 as he,aL as ge,C as Oe,aM as Ae,aN as ye,A as _,B as g,R as s,u as k,J as S,a3 as V,a2 as D,Q as C,S as I,Z as R,a9 as Ee,aO as ke,aP as xe,aQ as we,n as F}from"./element-plus.dee36745.js";import{g as x,s as w}from"./storage.9d517275.js";import"./el-tooltip.89296c46.js";import"./mockjs.f3824721.js";function Be(f){return typeof f=="function"||Object.prototype.toString.call(f)==="[object Object]"&&!re(f)}const Ce=N({props:{menuOption:{type:Object,default:{defaultOpeneds:["1"],defaultActive:"1-1",menu:[]}}},emits:["goMenu"],setup(f,{emit:A}){const B=(o,b)=>{A("goMenu",o,b)},c=(o,b)=>{if(b?.length)return b.map(t=>t.children?a(de,{key:t.sortId,index:t.sortId},{default:()=>[c(t,t.children)],title:()=>a("span",null,[t.title])}):a(ce,{index:t.sortId,onClick:()=>B(o,t)},{default:()=>[t.title]}))};return()=>{let o;return a(se,{width:"200px"},{default:()=>[a(ue,{"unique-opened":!0,"default-openeds":f.menuOption.defaultOpeneds,"default-active":f.menuOption.defaultActive},Be(o=c(void 0,f.menuOption.menu))?o:{default:()=>[o]})]})}}}),Me={class:"color-gray3"},Te={class:"home-toolbar color-gray3"},Se=N({__name:"index",setup(f){const A=z(),B=W(),c=X(),o=Y();A.keepAliveAction(ee);const{keepAliveInclude:b}=T(A);let t=E({defaultOpeneds:["1"],defaultActive:"1-1",menu:[]});const{userinfo:P}=T(B);let l=E([]),O=E(o.path),i=E([]);te(n=>{if(typeof n?.meta?.title=="string"&&!l.value.includes(n?.meta?.title))l.value.push(n.meta.title),w("breadcrumb",l.value),w("menuOption",{defaultOpeneds:t.value.defaultOpeneds,defaultActive:t.value.defaultActive});else{const e=l.value.findIndex(u=>u===n?.meta?.title),r=x("breadcrumb");e>-1&&(l.value=r?.slice(0,e+1),e!==r?.length-1&&w("breadcrumb",l.value))}});const j=({index:n})=>{if(!n)return;const e=i.value[~~n];!e||(O.value=e.path,t.value.defaultOpeneds=e.defaultOpeneds,t.value.defaultActive=e.defaultActive,l.value=e.breadcrumb,c.push({path:e.path}))},G=n=>{const e=i.value;i.value=e.filter(u=>u.path!==n);const r=i.value.length;if(r){const u=i.value[r-1];O.value=u.path,l.value=u.breadcrumb,t.value.defaultOpeneds=u.defaultOpeneds,t.value.defaultActive=u.defaultActive,c.back()}else t.value.defaultOpeneds=["1"],t.value.defaultActive="1-1",l.value=["Dashboard","\u5206\u6790\u9875"],c.push({path:"/dashboard/analysis"})},H=(n,e,r)=>{if(o.name){let u=!1;(function m(v,h,y){v.some(d=>{if(d.name===o.name)return F(()=>{t.value.defaultOpeneds=[`${h||d.sortId}`],t.value.defaultActive=d.sortId,l.value=y?[y,d.title]:[d.title],i.value.push({title:o.meta.title,path:o.path,defaultOpeneds:t.value.defaultOpeneds,defaultActive:t.value.defaultActive,breadcrumb:l.value})}),u=!0,!0;d.children?.length&&m(d.children,d.sortId,d.title)})})(n,e,r),u||F(()=>{const m=x("breadcrumb"),v=m?.findIndex(h=>h===o?.meta?.title);v>-1&&(l.value=m?.slice(0,v+1),v!==m?.length-1&&w("breadcrumb",l.value)),t.value.defaultOpeneds=x("menuOption")?.defaultOpeneds,t.value.defaultActive=x("menuOption")?.defaultActive})}};(async function(){const e=await ae.getMenu();t.value.menu=e,e&&H(e)})();const L=async()=>{await ne.logoutAction()&&c.replace({name:"Login"})},U=()=>{c.push({name:"SystemPassword"})},J=(n,e)=>{if(l.value=[n.title],t.value.menu,t.value.defaultOpeneds=[n.sortId],t.value.defaultActive=e.sortId,e.title&&e.path){let r=!!i.value.find(u=>u.title===e.title);O.value=e.path,r||i.value.push({title:e.title,defaultOpeneds:t.value.defaultOpeneds,defaultActive:t.value.defaultActive,breadcrumb:l.value,path:e.path})}e.name?c.push({name:e.name}):e.path&&c.push({path:e.path})};return(n,e)=>{const r=ie,u=pe,m=oe,v=fe,h=ve,y=_e,d=me,K=be,Q=he,q=ge,Z=Oe("router-view"),$=Ae,M=ye;return _(),g(M,{class:"layout-container"},{default:s(()=>[a(k(Ce),{"menu-option":t.value,onGoMenu:J},null,8,["menu-option"]),a(M,null,{default:s(()=>[a(d,{class:"home-header flex center between pos-r f12 color-black"},{default:s(()=>[a(u,{separator:"/"},{default:s(()=>[(_(!0),S(D,null,V(l.value,p=>(_(),g(r,{key:p},{default:s(()=>[C("span",Me,R(p),1)]),_:2},1024))),128))]),_:1}),C("div",Te,[a(y,null,{dropdown:s(()=>[a(h,null,{default:s(()=>[a(v,{onClick:L},{default:s(()=>[I("\u6CE8\u9500")]),_:1}),a(v,{onClick:U},{default:s(()=>[I("\u4FEE\u6539\u5BC6\u7801")]),_:1})]),_:1})]),default:s(()=>[a(m,{class:"mr10 color-gray3"})]),_:1}),C("span",null,R(k(P)?.username),1)])]),_:1}),i.value?.length?(_(),g(Q,{key:0,modelValue:O.value,"onUpdate:modelValue":e[0]||(e[0]=p=>O.value=p),closable:"",type:"card",class:"demo-tabs",onTabClick:j,onTabRemove:G},{default:s(()=>[(_(!0),S(D,null,V(i.value,p=>(_(),g(K,{key:p.path,label:p.title,name:p.path},null,8,["label","name"]))),128))]),_:1},8,["modelValue"])):Ee("",!0),a($,{class:"bg-gray"},{default:s(()=>[a(q,{target:".el-main"}),a(Z,null,{default:s(({Component:p})=>[a(ke,{name:"fade",mode:"out-in"},{default:s(()=>[(_(),g(xe,{include:k(b)},[(_(),g(we(p),{key:k(o).fullPath}))],1032,["include"]))]),_:2},1024)]),_:1})]),_:1})]),_:1})]),_:1})}}});const Ue=le(Se,[["__scopeId","data-v-c759d75a"]]);export{Ue as default};
